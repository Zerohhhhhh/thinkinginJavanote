# 第2章 一切都是对象(Everything is an object)

## 用引用操作对象

每种编程语言都有自己的操纵内存中元素的方式。在java中，一切都被视为对象，因此可采用单一固定的语法。尽管一切都看做对象，但操纵的标识符实际上是对象的一个“引用”（reference）。但是，你拥有一个引用，并不一定需要有一个对象与它关联。例如：

```java
String s;
```

此处只是创建了引用，还没有与对象关联在一次。要与对象关联在一起，例如：

```java
s = "thinking in java";
```

此时则引用“s”与String对象关联在一次。这个时候你可以对引用s进行操作。在引用没有关联对象时，操作引用就会返回一个<u>运行时错误</u>。

## 存储到什么地方

1.   寄存器。这是最快的存储区，因为它位于不同于其他存储区的地方一一处理器内部。但是寄存器的数量极其有限，所以寄存器根据需求进行分配。你不能直接控制，也不能在程序中感觉到寄存器存在的任何迹象 (另一方面， C和C++允许您向编译器建议寄存器的分配方式)。
2.   堆栈。位于通用RAM(随机访问存储器)中，但通过堆栈指针可以从处理器那里获得直接支持。堆栈指针若向下移动， 则分配新的内存，若向上移动， 则释放那些内存。这是一种快速有效的分配存储方法，仅次于寄存器。创建程序时，Java系统必须知道存储在堆栈内所有项的确切生命周期， 以便上下移动堆栈指针。 这一约束限制了程序的灵活性， 所以虽然某些Java数据存储于堆栈中一一特别是对象引用， 但是Java对象并不存储于其中。
3.   堆。一种通用的内存池(也位于RAM区)，用于存放所有的Java对象。堆不同于堆栈的好处是: 编译器不需要知道存储的数据在堆里存活多长时间。 因此， 在堆里分配存储有很大的灵活性。当需要一个对象时，只需用new写一行简单的代码，当执行这行代码时，会自动在堆里进行存储分配。 当然， 为这种灵活性必须要付出相应的代价: 用堆进行存储分配和清理可能比用堆栈进行存储分配需要更多的时间 (如果确实可以在Java中像在C++中一样在栈中创建对象)。
4.   常量存储。常量值通常直接存放在程序代码内部，这样做是安全的，因为它们永远不会被改变。 有时， 在嵌人式系统中， 常量本身会和其他部分隔离开， 所以在这种情况下， 可以选择将其存放在ROM(只读存储器)中。
5.   非RAM存储。如果数据完全存活于程序之外，那么它可以不受程序的任何控制，在程序没有运行时也可以存在。 其中两个基本的例子是流对象和持久化对象。 在流对象中， 对象转化成字节流，通常被发送给另一台机器。在“持久化对象”中，对象被存放于磁盘上，因此，印使程序终止，它们仍可以保持自己的状态。这种存储方式的技巧在干:把对象转化成可以存放在其他媒介上的事务，在需要时，可恢复成常规的、基于RAM的对象。

# 特例：基本类型

基本类型是一个并非是引用的“自动”变量。这个变量直接存储“值”，并置于堆栈中，因此更加高效。Java的基本类型所占存储空间大小不随机器硬件架构的变化而变化。（部分编程语言会变化）

