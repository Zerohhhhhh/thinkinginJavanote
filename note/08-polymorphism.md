# 第8章 多态

***在面向对象的程序设计语言中，多态是继数据抽象和继承之后的第三种基本特征***

1. **多态**通过分离做什么和怎么做，从另一角度将接口和实现分离出来。

2. **“封装”**通过合并特征和行为来创建新的数据类型。

3. **“实现隐藏”**则通过将细节“私有化”把接口和实现分离开来。

**多态的作用**则是消除类型之间的耦合关系。

## 再论向上转型

对象既可以作为它自己本身的类型使用，也可以作为它的基类型使用。这种把对某个对象的引用视为对其基类型的引用的做法被称作为**向上转型**。

## 方法调用绑定

1. **绑定：将一个方法调用同一个方法主体关联起来被称作绑定。**
2. **前期绑定：若在程序执行前进行绑定（如果有的话，由编译器和连接程序实现）。面向过程语言中默认的绑定方式（例如C语言）。**
3. **后期绑定：在运行时根据对象的类型进行绑定。也叫动态绑定或运行时绑定。**采用后期绑定的语言具有某种机制，程序运行时能判断对象的类型，从而调用恰当的方法。也就是说，编译器一直不知道对象的类型，但是方法调用机制能够找到正确的方法体，并加以调用。

***<u>java中除了static方法和final方法（private方法属于final方法）之外，其他所有的方法都是后期绑定。即程序员不必判定是否应该进行后期绑定，它会自动发生。</u>***

### 方法声明为final的更重要意义

将某个方法声明为final，除了防止其他人覆盖该方法，**更重要的是可以有效地“关闭”动态绑定，或者说，告诉编译器不需要对其进行动态绑定。**

编译器可以为final方法调用生成更有效的代码，但是这样对程序整体性能不会太大提高，因此不应该试图提高性能而使用final，而是出于程序设计来决定。

### 产生正确的行为

![08-Polymorphism01](https://github.com/Zerohhhhhh/thinkinginJavanote/blob/603e6033282df37cb829d0c8b9944463d32bff3a/images/08-Polymorphism01.jpg)

在“几何形状”这个例子中，有一个基类Shape，以及多个导出类——Circle、Square和Triangle等。

向上转型可以像下面这条语句：

```java
Shape s = new Circle();
```

创建一个Circle对象，并把得到的引用立即赋值给Shape。因为通过继承，Circle就是一种Shape。假如调用一个基类方法（该方法已在导出类中被覆盖）：

```java
s.draw();	
```

由于后期绑定（多态），因此上述语句还是正确调用Circle.draw()方法。